"0","mkoa.mkoa = toka %>% bind_cols(enda) %>% "
"0","  group_by(mikoa, region) %>% "
"0","  count() %>% "
"0","  datawizard::reshape_wider(values_from = ""n"", colnames_from = ""region"") %>% "
"0","  mutate( across(contains(""n_""), ~ifelse(is.na(.x),0,.x))) %>% "
"0","  slice(-27) %>% "
"0","  dplyr::select(-n_NA) "
"0",""
"0","majina = mkoa.mkoa %>% names() %>% as_tibble() %>% separate(col = 1, into = c(""aa"", ""bb""), sep = ""_"") %>% mutate(bb = if_else(is.na(bb), ""mikoa"", bb)) %>% pull(bb) "
"0",""
"0","names(mkoa.mkoa) = majina"
"0",""
"0",""
"0","mkoa.matrix = mkoa.mkoa %>% "
"0","  column_to_rownames(var = 'mikoa') %>% "
"0","  as.matrix() "
"0",""
"0",""
"0","mkoa.matrix %>% "
"0","  chorddiag("
"0","    type = ""bipartite"", "
"0","            showTicks = F, tickInterval = 2,"
"0","            groupnameFontsize = 14, "
"0","            groupnamePadding = 10, "
"0","    groupColors = hcl.colors(n = 30, palette = ""Berlin""),"
"0","            margin = 90, "
"0","            showGroupnames = T"
"0","  )"
