---
title: Combining plots in R
author: Masumbuko Semba
date: '2023-01-01'
slug: []
categories:
  - ggplot2
  - R
tags:
  - Masumbuko Semba
  - R
  - visualization
description: 'The ggplot2 package doesn’t provide a function to arrange multiple plots in a single figure '
thumbnail: ''
bibliography: "../blog.bib"
---



<p>The ggplot2 package doesn’t provide a function to arrange multiple plots in a single figure <span class="citation">(<a href="#ref-ggplot" role="doc-biblioref">Wickham 2016</a>)</span>. Still, some packages allow combining multiple plots into a single figure with custom layouts, width, and height, such as cowplot <span class="citation">(<a href="#ref-cowplot" role="doc-biblioref">Wilke 2018</a>)</span>, gridExtra, and patchwork <span class="citation">(<a href="#ref-patchwork" role="doc-biblioref">Pedersen 2020</a>)</span>.</p>
<p>In this post we are going to use several packages, let’us load them in our session</p>
<pre class="r"><code>require(tidyverse)
require(patchwork)
require(cowplot)</code></pre>
<p>Sample datasets</p>
<pre class="r"><code># tuna = tibble(
#   tl = runif(n = 120, min = 30, max = 120),
#   seasons = rep(c(&quot;Northeast&quot;, &quot;Southeast&quot;, &quot;Inter&quot;), each = 40)
# )

tuna = tibble(
  tl = c(rnorm(n = 40, mean = 80, sd = 30), 
            rnorm(n = 40, mean = 61,10),
            rnorm(n = 40, mean = 96, 25)),
  seasons = rep(c(&quot;Northeast&quot;, &quot;Southeast&quot;, &quot;Inter&quot;), each = 40)
)</code></pre>
<pre class="r"><code>ridges = tuna %&gt;% 
  ggplot() +
  ggridges::geom_density_ridges(aes(x = tl, y = seasons, fill = seasons), position = &quot;identity&quot;, alpha = .6)+
  theme(legend.position = &quot;none&quot;)

ridges</code></pre>
<p><img src="staticunnamed-chunk-3-1.png" width="672" /></p>
<pre class="r"><code>box = tuna %&gt;% 
  ggplot(aes(x = seasons, y = tl)) +
  geom_boxplot(fill = &quot;cyan4&quot;)

  box</code></pre>
<p><img src="staticunnamed-chunk-4-1.png" width="672" /></p>
<pre class="r"><code>hist = tuna %&gt;% 
  ggplot(aes(x = tl, fill = seasons, color = seasons)) +
  geom_histogram(bins = 8,position = &quot;identity&quot;, alpha = .4)

hist</code></pre>
<p><img src="staticunnamed-chunk-5-1.png" width="672" /></p>
<div id="gridextra" class="section level3">
<h3>gridExtra</h3>
<p>The gridExtra package provides the <code>grid.arrange</code> function to combine several plots on a single figure.</p>
<pre class="r"><code>gridExtra::grid.arrange(hist, box, ridges)</code></pre>
<p><img src="staticunnamed-chunk-6-1.png" width="672" /></p>
<p>We can also specify the number of rows with nrow, the number of columns with ncol, and the sizes with widths and heights, and also we can add labels at the top, bottom, left, and right of the figures.</p>
<pre class="r"><code>gridExtra::grid.arrange(hist, box, ridges, nrow = 2, top = &quot;Top Panel&quot;, bottom = &quot;Bottom Panel&quot;)</code></pre>
<p><img src="staticunnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="patchwork" class="section level3">
<h3>Patchwork</h3>
<p><strong>patchwork</strong> is designed to combine ggplot2 plots into the same figure easily. You only need to call the package in the session and then do the manipulation</p>
<p>For instance, we combine plots using <code>+</code> operator</p>
<pre class="r"><code>hist + box + ridges</code></pre>
<p><img src="staticunnamed-chunk-8-1.png" width="672" /></p>
<p>The | operator places plots in a row. This operator is similar to + when you have two plots but | will place all plots in a single row while + will try to create a square layout if possible.</p>
<pre class="r"><code>hist | ridges</code></pre>
<p><img src="staticunnamed-chunk-9-1.png" width="672" /></p>
<p>if we want to arrange plots along a column (stack), then we use the <code>/</code> operator</p>
<pre class="r"><code>hist / ridges</code></pre>
<p><img src="staticunnamed-chunk-10-1.png" width="672" /></p>
<p>We can create complex layouts. The | and / operators can be used to create complex layouts combining plots. In the following example, we are creating a layout with two plots at the top and one wider at the bottom.</p>
<pre class="r"><code>(hist / ridges)| box</code></pre>
<p><img src="staticunnamed-chunk-11-1.png" width="672" /></p>
<p>Similary, we can swap the operator and see the different of the figure below as compared to the previous one</p>
<pre class="r"><code>(hist | ridges)/ box</code></pre>
<p><img src="staticunnamed-chunk-12-1.png" width="672" /></p>
<p>You can add a title, subtitle, and captions to all plots with the plot_annotation function.</p>
<pre class="r"><code>(hist | ridges)/ box + plot_annotation(tag_levels = &quot;A&quot;)</code></pre>
<p><img src="staticunnamed-chunk-13-1.png" width="672" /></p>
<p>The labels can be customized with the tag_prefix, tag_suffix, and tag_sep arguments.</p>
<pre class="r"><code>(hist | ridges)/ box + plot_annotation(tag_levels = &quot;A&quot;, tag_prefix = &quot;Plot &quot;)</code></pre>
<p><img src="staticunnamed-chunk-14-1.png" width="672" /></p>
<pre class="r"><code>box +geom_jitter(color = &quot;cyan3&quot;)</code></pre>
<p><img src="staticunnamed-chunk-15-1.png" width="672" /></p>
<p>patchwork also provides the &amp; operator to modify all the plots at the same time to set the same theme for all plots at the same time.</p>
<pre class="r"><code>(hist | box)/ ridges   &amp; theme_classic()</code></pre>
<p><img src="staticunnamed-chunk-16-1.png" width="672" /></p>
<p>If you want to label each plot individually you can make use of the labels argument of the function, where you can specify a vector of labels or use the “A” or “a” keywords for automatic labels in uppercase or lowercase, respectively. The function also provides several arguments to customize the style of the texts.</p>
<pre class="r"><code>plot_grid(hist, box, ridges, labels = c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;), label_fontfamily = &quot;serif&quot;, label_fontface = &quot;bold&quot;, label_colour = &quot;dodgerblue2&quot;)</code></pre>
<p><img src="staticunnamed-chunk-17-1.png" width="672" />
With cowplot you can also create more complex layouts combining <code>plot_grid</code> functions, as shown in the example below, where we are creating a layout with two plots at the bottom and one at the top.</p>
<pre class="r"><code>plot_grid(plot_grid(hist, ridges), box, rows = 2)</code></pre>
<p><img src="staticunnamed-chunk-18-1.png" width="672" /></p>
</div>
<div id="references" class="section level3 unnumbered">
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-patchwork" class="csl-entry">
Pedersen, Thomas Lin. 2020. <em>Patchwork: The Composer of Plots</em>. <a href="https://CRAN.R-project.org/package=patchwork">https://CRAN.R-project.org/package=patchwork</a>.
</div>
<div id="ref-ggplot" class="csl-entry">
Wickham, Hadley. 2016. <em>Ggplot2: Elegant Graphics for Data Analysis</em>. Springer-Verlag New York. <a href="https://ggplot2.tidyverse.org">https://ggplot2.tidyverse.org</a>.
</div>
<div id="ref-cowplot" class="csl-entry">
Wilke, Claus O. 2018. <em>Cowplot: Streamlined Plot Theme and Plot Annotations for ’Ggplot2’</em>. <a href="https://CRAN.R-project.org/package=cowplot">https://CRAN.R-project.org/package=cowplot</a>.
</div>
</div>
</div>
